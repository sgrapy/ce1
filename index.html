<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Math CE1 - TNI</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <!-- Background (semi-transparent via CSS) -->
  <div class="bg"></div>

  <header class="topbar">
    <div class="brand">
      <div class="app-tabs" id="appTabs" role="tablist" aria-label="Modules CE1">
        <button type="button" class="app-tab active" data-app="math" aria-selected="true">ğŸ§® Math CE1</button>
        <button type="button" class="app-tab" data-app="english" aria-selected="false">ğŸ‡¬ğŸ‡§ Anglais CE1</button>
        <button type="button" class="app-tab app-tab-disabled" data-app="french" aria-selected="false" disabled>ğŸ‡«ğŸ‡· FranÃ§ais CE1</button>
      </div>
    </div>

    <div class="topbar-actions">
      <!-- RÃ©glages appli (modal) -->
      <button id="btnSettings" class="btn btn-ghost" title="RÃ©glages">âš™ï¸</button>

      <!-- Plein Ã©cran -->
      <button id="btnFullscreen" class="btn btn-ghost" title="Plein Ã©cran">â›¶</button>

      <!-- Fin de partie (visible seulement en jeu) -->
      <button id="btnEndHeader" class="btn btn-ghost hidden" title="Fin">â¹</button>
    </div>
  </header>

  <main class="app">

    <!-- MENU -->
    <section id="screenMenu" class="panel panel-wide">
      <div class="menu-title">
        <h1>ğŸ’ PrÃ©parer la sÃ©ance</h1>
        <div class="menu-sub">Choisis lâ€™exercice, les joueurs et les rÃ©glages.</div>
      </div>

      <div class="menu-layout">
        <!-- Colonne gauche -->
        <div class="menu-col">

          <div class="card">
            <h2>ğŸ§© SÃ©ance</h2>

            <!-- RÃ©glages principaux (plus lisibles) -->
            <div class="row2eq">
              <div class="field">
                <label>Exercice</label>
                <select id="exerciseType">
                  <option value="add">â• Addition</option>
                  <option value="sub">â– Soustraction</option>
                  <option value="mul">âœ–ï¸ Multiplication</option>
                  <option value="div">â— Division</option>
                  <option value="eng">ğŸ‡¬ğŸ‡§ Anglais (Couleurs)</option>
                </select>
              </div>

              <div class="field">
                <label>RÃ©ponses</label>
                <select id="answerMode">
                  <option value="mcq">ğŸˆ QCM (ballons)</option>
                  <option value="keypad">â˜ï¸ Clavier</option>
                </select>
              </div>
            </div>

            <!-- Mode de jeu + paramÃ¨tre sur la mÃªme ligne -->
            <div class="row2eq">
              <div class="field">
                <label>Mode de jeu</label>
                <select id="gameMode">
                  <option value="time">â± Temps</option>
                  <option value="race">ğŸ Premier Ã  X</option>
                </select>
              </div>

              <div class="field">
                <div class="subfield" id="timeWrap">
                  <label class="sub-label">DurÃ©e (sec)</label>
                  <input id="durationSec" type="number" min="10" max="3600" step="5" value="60" />
                </div>

                <div class="subfield hidden" id="raceTargetWrap">
                  <label class="sub-label">Premier Ã  (points)</label>
                  <input id="raceTarget" type="number" min="1" max="200" step="1" value="10" />
                </div>
              </div>
            </div>

            <!-- Options: rapides vs avancÃ©es -->
            <div class="options-head">
              <div class="options-head-left">
                <div class="options-title">âš™ï¸ Options</div>
                <div class="options-desc">Choisis une vue : rapide ou avancÃ©e</div>
              </div>

              <div class="seg-tabs" id="optionsTabs" role="tablist" aria-label="Options">
                <button type="button" class="seg-tab active" id="tabQuick" data-options="quick" aria-selected="true">âš¡ Rapides</button>
                <button type="button" class="seg-tab" id="tabAdvanced" data-options="advanced" aria-selected="false">ğŸ§  AvancÃ©es</button>
              </div>
            </div>

            <div class="opt-grid opt-grid-1" id="optionsQuick">
              <label class="opt-tile" id="tileExplain">
                <div class="opt-text">
                  <div class="opt-title">ğŸ“˜ Explications</div>
                  <div class="opt-desc">Afficher une aide seulement en cas dâ€™erreur</div>
                </div>
                <input id="showExplainOption" type="checkbox" checked />
                <span class="opt-switch" aria-hidden="true"></span>
              </label>
            </div>

            <div class="opt-grid hidden" id="optionsAdvanced">
              <label class="opt-tile" id="tileAuto">
                <div class="opt-text">
                  <div class="opt-title">ğŸ® DifficultÃ© auto</div>
                  <div class="opt-desc">La difficultÃ© augmente pendant la partie</div>
                </div>
                <input id="autoDifficulty" type="checkbox" />
                <span class="opt-switch" aria-hidden="true"></span>
              </label>

              <label class="opt-tile" id="tileExpert">
                <div class="opt-text">
                  <div class="opt-title">ğŸ† Mode Expert</div>
                  <div class="opt-desc">Sans explications â€¢ records enregistrÃ©s</div>
                </div>
                <input id="expertMode" type="checkbox" />
                <span class="opt-switch" aria-hidden="true"></span>
              </label>

              <label class="opt-tile" id="tileTeam">
                <div class="opt-text">
                  <div class="opt-title">ğŸ¤ Mode Ã©quipe</div>
                  <div class="opt-desc">Additionne les scores par Ã©quipe</div>
                </div>
                <input id="teamMode" type="checkbox" />
                <span class="opt-switch" aria-hidden="true"></span>
              </label>
            </div>

            <div class="team-options hidden" id="teamOptions">
              <div class="field">
                <label>Nombre d'Ã©quipes</label>
                <select id="teamCount">
                  <option value="2" selected>2</option>
                  <option value="3">3</option>
                  <option value="4">4</option>
                </select>
              </div>
              <div class="team-hint">
                <small>Assigne chaque joueur Ã  une Ã©quipe juste en dessous ğŸ‘‡</small>
              </div>
            </div>
          </div>

          <div class="card">
            <h2>ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ Joueurs</h2>

            <div class="row2">
              <div class="field">
                <label>Nombre</label>
                <select id="playersCount">
                  <option value="1">1</option>
                  <option value="2">2</option>
                  <option value="3">3</option>
                  <option value="4" selected>4</option>
                </select>
              </div>
            </div>

            <div id="playersInputs" class="players-inputs players-nice"></div>
          </div>

        </div>

        <!-- Colonne droite -->
        <div class="menu-col">
          <div class="card">
            <h2 id="mathTitle">âš™ï¸ RÃ©glages (Addition)</h2>
            <div id="mathSettings" class="math-grid nice-grid"></div>
          </div>

          <div class="card">
            <h2>ğŸ‘¨â€ğŸ« Mode prof</h2>
            <div class="row2">
              <button id="btnOpenStats" class="btn">ğŸ“Š Stats & Records</button>
              <button id="btnResetStats" class="btn btn-ghost">ğŸ§¹ Reset stats</button>
            </div>
            <small>Les stats/records sont enregistrÃ©s sur cet appareil (localStorage).</small>
          </div>

          <div class="card launch-card">
            <button id="btnStart" class="btn btn-primary btn-launch">â–¶ï¸ Lancer la partie</button>
          </div>
        </div>
      </div>
    </section>


    <!-- ENGLISH -->
    <section id="screenEnglish" class="panel panel-wide hidden">
      <div class="menu-title">
        <h1>ğŸ‡¬ğŸ‡§ Anglais CE1</h1>
        <div class="menu-sub">Couleurs : clique sur une couleur pour voir le mot en anglais.</div>
      </div>

      <div class="menu-layout">
        <div class="menu-col">
          <div class="card">
            <h2>ğŸ¨ Les couleurs</h2>

            <div class="colors-grid" id="colorsGrid">
              <button type="button" class="color-card" data-fr="Rouge" data-en="Red" style="--swatch:#ef4444">
                <span class="swatch"></span>
                <span class="label">Rouge</span>
              </button>
              <button type="button" class="color-card" data-fr="Bleu" data-en="Blue" style="--swatch:#3b82f6">
                <span class="swatch"></span>
                <span class="label">Bleu</span>
              </button>
              <button type="button" class="color-card" data-fr="Vert" data-en="Green" style="--swatch:#22c55e">
                <span class="swatch"></span>
                <span class="label">Vert</span>
              </button>
              <button type="button" class="color-card" data-fr="Jaune" data-en="Yellow" style="--swatch:#f59e0b">
                <span class="swatch"></span>
                <span class="label">Jaune</span>
              </button>
              <button type="button" class="color-card" data-fr="Orange" data-en="Orange" style="--swatch:#fb923c">
                <span class="swatch"></span>
                <span class="label">Orange</span>
              </button>
              <button type="button" class="color-card" data-fr="Violet" data-en="Purple" style="--swatch:#a855f7">
                <span class="swatch"></span>
                <span class="label">Violet</span>
              </button>
              <button type="button" class="color-card" data-fr="Rose" data-en="Pink" style="--swatch:#ec4899">
                <span class="swatch"></span>
                <span class="label">Rose</span>
              </button>
              <button type="button" class="color-card" data-fr="Marron" data-en="Brown" style="--swatch:#8b5a2b">
                <span class="swatch"></span>
                <span class="label">Marron</span>
              </button>
            </div>

            <div class="ce1-text" style="margin-top:12px;">
              <p><b>Astuce :</b> clique une carte pour basculer <b>FR â†” EN</b> ğŸ˜Š</p>
            </div>
          </div>

          <div class="card launch-card">
            <button id="btnBackToMath" class="btn btn-primary btn-launch">â†©ï¸ Retour Ã  Math</button>
          </div>
        </div>

        <div class="menu-col">
          <div class="card">
            <h2>ğŸ“Œ Ã€ venir</h2>
            <div class="ce1-text">
              <p>âœ… Couleurs</p>
              <p>ğŸ”œ Animaux â€¢ Nombres â€¢ Petites phrases</p>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- GAME -->
    <section id="screenGame" class="game hidden">
      <div class="hud">
        <div id="hudMode" class="pill">Mode</div>
        <div id="hudSkill" class="pill">CompÃ©tence</div>
        <div id="hudTimer" class="pill">â± 60s</div>
        <button id="btnEnd" class="btn btn-ghost">â¹ Fin</button>
      </div>

      <div id="gameGrid" class="game-grid"></div>
    </section>

  </main>

  <!-- MODAL: RÃ©glages application -->
  <div id="appSettingsModal" class="modal hidden">
    <div class="modal-backdrop" data-close="1"></div>

    <div class="modal-card">
      <div class="modal-head">
        <h2>âš™ï¸ RÃ©glages application</h2>
        <button class="btn btn-ghost" id="btnCloseSettings">âœ•</button>
      </div>

      <div class="settings-grid">
        <div class="field">
          <label>Type dâ€™Ã©cran</label>
          <select id="screenProfile">
            <option value="tni">TNI / TBI</option>
            <option value="laptop">Ordi / portable</option>
            <option value="mobile">Mobile</option>
          </select>
        </div>

        <div class="field">
          <label>Version</label>
          <div class="about-box" id="appVersion">v1.0.0</div>
        </div>

        <div class="field">
          <label>Maintenance</label>
          <button id="btnReset" class="btn">ğŸ§¹ Vider rÃ©glages</button>
          <small>Efface les rÃ©glages enregistrÃ©s (localStorage).</small>
        </div>
      </div>
    </div>
  </div>

  <!-- MODAL: Stats & Records -->
  <div id="statsModal" class="modal hidden">
    <div class="modal-backdrop" data-close="1"></div>
    <div class="modal-card modal-wide">
      <div class="modal-head">
        <h2>ğŸ“Š Statistiques & Records</h2>
        <button class="btn btn-ghost" id="btnCloseStats">âœ•</button>
      </div>

      <div class="tabs">
        <button class="tab active" data-tab="records">ğŸ† Records</button>
        <button class="tab" data-tab="sessions">ğŸ“… Parties</button>
      </div>

      <div id="tabRecords" class="tab-panel"></div>
      <div id="tabSessions" class="tab-panel hidden"></div>

      <div class="modal-footer">
        <button id="btnResetStats2" class="btn btn-ghost">ğŸ§¹ Reset stats</button>
      </div>
    </div>
  </div>

  <!-- MODAL: RÃ©sultats (podium) -->
  <div id="resultsModal" class="modal hidden">
    <div class="modal-backdrop" data-close="1"></div>
    <div class="modal-card modal-wide">
      <div class="modal-head">
        <h2>ğŸ¥‡ RÃ©sultats</h2>
        <button class="btn btn-ghost" id="btnCloseResults">âœ•</button>
      </div>

      <div id="resultsContent"></div>

      <div class="modal-footer">
        <button id="btnBackToMenu" class="btn btn-primary">â†©ï¸ Retour menu</button>
      </div>
    </div>
  </div>

  <script type="module" src="js/main.js"></script>
</body>
</html>
