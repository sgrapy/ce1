<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Math CE1 - TNI</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <!-- Background (semi-transparent via CSS) -->
  <div class="bg"></div>

  <header class="topbar">
    <div class="brand">ğŸˆ Math CE1</div>

    <div class="topbar-actions">
      <!-- RÃ©glages appli (modal) -->
      <button id="btnSettings" class="btn btn-ghost" title="RÃ©glages">âš™ï¸</button>

      <!-- Plein Ã©cran -->
      <button id="btnFullscreen" class="btn btn-ghost" title="Plein Ã©cran">â›¶</button>

      <!-- Fin de partie (visible seulement en jeu) -->
      <button id="btnEndHeader" class="btn btn-ghost hidden" title="Fin">â¹</button>
    </div>
  </header>

  <main class="app">

    <!-- MENU -->
    <section id="screenMenu" class="panel panel-wide">
      <div class="menu-title">
        <h1>ğŸ’ PrÃ©parer la sÃ©ance</h1>
        <div class="menu-sub">Choisis lâ€™exercice, les joueurs et les rÃ©glages.</div>
      </div>

      <div class="menu-layout">
        <!-- Colonne gauche -->
        <div class="menu-col">

          <div class="card">
            <h2>ğŸ§© SÃ©ance</h2>

            <!-- RÃ©glages principaux (plus lisibles) -->
            <div class="row2eq">
              <div class="field">
                <label>Exercice</label>
                <select id="exerciseType">
                  <option value="add">â• Addition</option>
                  <option value="sub">â– Soustraction</option>
                  <option value="mul">âœ–ï¸ Multiplication</option>
                  <option value="div" disabled>â— Division (bientÃ´t)</option>
                </select>
              </div>

              <div class="field">
                <label>RÃ©ponses</label>
                <select id="answerMode">
                  <option value="mcq">ğŸˆ QCM (ballons)</option>
                  <option value="keypad">â˜ï¸ Clavier</option>
                </select>
              </div>
            </div>

            <!-- Mode de jeu + paramÃ¨tre sur la mÃªme ligne -->
            <div class="row2eq">
              <div class="field">
                <label>Mode de jeu</label>
                <select id="gameMode">
                  <option value="time">â± Temps</option>
                  <option value="race">ğŸ Premier Ã  X</option>
                </select>
              </div>

              <div class="field">
                <div class="subfield" id="timeWrap">
                  <label class="sub-label">DurÃ©e (sec)</label>
                  <input id="durationSec" type="number" min="10" max="3600" step="5" value="60" />
                </div>

                <div class="subfield hidden" id="raceTargetWrap">
                  <label class="sub-label">Premier Ã  (points)</label>
                  <input id="raceTarget" type="number" min="1" max="200" step="1" value="10" />
                </div>
              </div>
            </div>

            <!-- Options: rapides vs avancÃ©es -->
            <div class="options-head">
              <div class="options-head-left">
                <div class="options-title" id="optionsTitle">âš¡ Options rapides</div>
                <div class="options-desc" id="optionsDesc">RÃ©glages essentiels pour dÃ©marrer vite</div>
              </div>

              <button id="btnAdvancedOnly" type="button" class="btn btn-mini btn-ghost">
                âš™ï¸ Afficher seulement les options avancÃ©es
              </button>
            </div>

            <div class="opt-grid opt-grid-1" id="optionsQuick">
              <label class="opt-tile" id="tileExplain">
                <div class="opt-text">
                  <div class="opt-title">ğŸ“˜ Explications</div>
                  <div class="opt-desc">Afficher une aide seulement en cas dâ€™erreur</div>
                </div>
                <input id="showExplainOption" type="checkbox" checked />
                <span class="opt-switch" aria-hidden="true"></span>
              </label>
            </div>

            <div class="opt-grid hidden" id="optionsAdvanced">
              <label class="opt-tile" id="tileAuto">
                <div class="opt-text">
                  <div class="opt-title">ğŸ® DifficultÃ© auto</div>
                  <div class="opt-desc">La difficultÃ© augmente pendant la partie</div>
                </div>
                <input id="autoDifficulty" type="checkbox" />
                <span class="opt-switch" aria-hidden="true"></span>
              </label>

              <label class="opt-tile" id="tileExpert">
                <div class="opt-text">
                  <div class="opt-title">ğŸ† Mode Expert</div>
                  <div class="opt-desc">Sans explications â€¢ records enregistrÃ©s</div>
                </div>
                <input id="expertMode" type="checkbox" />
                <span class="opt-switch" aria-hidden="true"></span>
              </label>

              <label class="opt-tile" id="tileTeam">
                <div class="opt-text">
                  <div class="opt-title">ğŸ¤ Mode Ã©quipe</div>
                  <div class="opt-desc">Additionne les scores par Ã©quipe</div>
                </div>
                <input id="teamMode" type="checkbox" />
                <span class="opt-switch" aria-hidden="true"></span>
              </label>
            </div>

            <div class="team-options hidden" id="teamOptions">
              <div class="field">
                <label>Nombre d'Ã©quipes</label>
                <select id="teamCount">
                  <option value="2" selected>2</option>
                  <option value="3">3</option>
                  <option value="4">4</option>
                </select>
              </div>
              <div class="team-hint">
                <small>Assigne chaque joueur Ã  une Ã©quipe juste en dessous ğŸ‘‡</small>
              </div>
            </div>
          </div>

          <div class="card">
            <h2>ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ Joueurs</h2>

            <div class="row2">
              <div class="field">
                <label>Nombre</label>
                <select id="playersCount">
                  <option value="1">1</option>
                  <option value="2">2</option>
                  <option value="3">3</option>
                  <option value="4" selected>4</option>
                </select>
              </div>
            </div>

            <div id="playersInputs" class="players-inputs players-nice"></div>
          </div>

        </div>

        <!-- Colonne droite -->
        <div class="menu-col">
          <div class="card">
            <h2 id="mathTitle">âš™ï¸ RÃ©glages (Addition)</h2>
            <div id="mathSettings" class="math-grid nice-grid"></div>
          </div>

          <div class="card">
            <h2>ğŸ‘¨â€ğŸ« Mode prof</h2>
            <div class="row2">
              <button id="btnOpenStats" class="btn">ğŸ“Š Stats & Records</button>
              <button id="btnResetStats" class="btn btn-ghost">ğŸ§¹ Reset stats</button>
            </div>
            <small>Les stats/records sont enregistrÃ©s sur cet appareil (localStorage).</small>
          </div>

          <div class="card launch-card">
            <button id="btnStart" class="btn btn-primary btn-launch">â–¶ï¸ Lancer la partie</button>
          </div>
        </div>
      </div>
    </section>

    <!-- GAME -->
    <section id="screenGame" class="game hidden">
      <div class="hud">
        <div id="hudMode" class="pill">Mode</div>
        <div id="hudSkill" class="pill">CompÃ©tence</div>
        <div id="hudTimer" class="pill">â± 60s</div>
        <button id="btnEnd" class="btn btn-ghost">â¹ Fin</button>
      </div>

      <div id="gameGrid" class="game-grid"></div>
    </section>

  </main>

  <!-- MODAL: RÃ©glages application -->
  <div id="appSettingsModal" class="modal hidden">
    <div class="modal-backdrop" data-close="1"></div>

    <div class="modal-card">
      <div class="modal-head">
        <h2>âš™ï¸ RÃ©glages application</h2>
        <button class="btn btn-ghost" id="btnCloseSettings">âœ•</button>
      </div>

      <div class="settings-grid">
        <div class="field">
          <label>Type dâ€™Ã©cran</label>
          <select id="screenProfile">
            <option value="tni">TNI / TBI</option>
            <option value="laptop">Ordi / portable</option>
            <option value="mobile">Mobile</option>
          </select>
        </div>

        <div class="field">
          <label>Version</label>
          <div class="about-box" id="appVersion">v1.0.0</div>
        </div>

        <div class="field">
          <label>Maintenance</label>
          <button id="btnReset" class="btn">ğŸ§¹ Vider rÃ©glages</button>
          <small>Efface les rÃ©glages enregistrÃ©s (localStorage).</small>
        </div>
      </div>
    </div>
  </div>

  <!-- MODAL: Stats & Records -->
  <div id="statsModal" class="modal hidden">
    <div class="modal-backdrop" data-close="1"></div>
    <div class="modal-card modal-wide">
      <div class="modal-head">
        <h2>ğŸ“Š Statistiques & Records</h2>
        <button class="btn btn-ghost" id="btnCloseStats">âœ•</button>
      </div>

      <div class="tabs">
        <button class="tab active" data-tab="records">ğŸ† Records</button>
        <button class="tab" data-tab="sessions">ğŸ“… Parties</button>
      </div>

      <div id="tabRecords" class="tab-panel"></div>
      <div id="tabSessions" class="tab-panel hidden"></div>

      <div class="modal-footer">
        <button id="btnResetStats2" class="btn btn-ghost">ğŸ§¹ Reset stats</button>
      </div>
    </div>
  </div>

  <!-- MODAL: RÃ©sultats (podium) -->
  <div id="resultsModal" class="modal hidden">
    <div class="modal-backdrop" data-close="1"></div>
    <div class="modal-card modal-wide">
      <div class="modal-head">
        <h2>ğŸ¥‡ RÃ©sultats</h2>
        <button class="btn btn-ghost" id="btnCloseResults">âœ•</button>
      </div>

      <div id="resultsContent"></div>

      <div class="modal-footer">
        <button id="btnBackToMenu" class="btn btn-primary">â†©ï¸ Retour menu</button>
      </div>
    </div>
  </div>

  <script type="module" src="js/main.js"></script>
</body>
</html>
